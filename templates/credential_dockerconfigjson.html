{% extends "base.html" %}
{% block content %}
<div class="card mb-3 border-light">
    <div class="card-body">
        <h4 class="d-flex justify-content-between align-items-center mb-3">
            <span class="text-primary">
                Credential: {{ secret.name }}
            </span>
        </h4>
        {% if (secret.get('annotations', {}).get('cm_readonly') or secret.get('annotations', {}).get('cm_keyonly')) %}
        <div class="d-flex justify-content-between align-items-center mb-3">
            <small class="text-secondary">
                {% if secret.get('annotations', {}).get('cm_keyonly') %}
                &#128273; confidential
                {% else %}
                &#128274; readonly
                {% endif %}
            </small>
        </div>
        {% endif %}

        <form method="POST">
            <input type="hidden" name="credentials_name" value="{{ secret.name }}">
            <input type="hidden" name="type" value="kubernetes.io/dockerconfigjson">
            <input type="hidden" name="create" value="yes">
            {% if is_new_credential %} <h6>Type: dockerconfigjson</h6> {% endif %}
            <div class="clearfix"></div>
            <h5>Provide <b>your credentials</b>:</h5>
            <div class="mb-3">
                <input type="text" class="form-control" id="registry" name="registry" required value="{{ secret.data.get('registry', '') }}">
                <label for="registry" class="form-label">
                    Registry server FQDN (required)
                </label>
                <input type="text" class="form-control" id="user" name="user" value="{{ secret.data.get('user', '') }}">
                <label for="user" class="form-label">
                    Username
                </label>
                <input type="text" class="form-control" id="password" name="password" value="{{ secret.data.get('password', '') }}">
                <label for="password" class="form-label">
                    Password
                </label>
                <input type="text" class="form-control" id="auth" name="auth" value="{{ secret.data.get('auth', '') }}">
                <label for="auth" class="form-label">
                    Authentication key (not encoded)
                </label>
            </div>
            <h5>Current <b>dockerconfigjson</b>:</h5>
            <div class="mb-3">
                <textarea class="form-control" id="dockercfg" name="dockercfg" style="min-height: 100px;" disabled>{{ secret.data.get('.dockerconfigjson', '') }}</textarea>
            </div>
            <br>
            <div id="form-buttons">
                {% if not (secret.get('annotations', {}).get('cm_readonly') or secret.get('annotations', {}).get('cm_keyonly')) %}
                <button type="submit" class="btn btn-success my-2">
                    {% if is_new_credential %} Create {% else %} Update {% endif %} Credential
                </button>
                {% endif %}
                <a href="../" type="button" class="btn btn-secondary">
                    {% if (secret.get('annotations', {}).get('cm_readonly') or secret.get('annotations', {}).get('cm_keyonly')) %}
                        Return
                    {% else %}
                        Cancel
                    {% endif %}</a>
            </div>
        </form>
    </div>
</div>

{% endblock %}

{% extends "base.html" %}
{% block content %}
<div class="card mb-3 border-light">
    <div class="card-body">
        <h4 class="d-flex justify-content-between align-items-center mb-3">
            <span class="text-primary">
                Credential: {{ secret.name }}
            </span>
        </h4>
        {% if (secret.get('annotations', {}).get('cm_readonly') or secret.get('annotations', {}).get('cm_keyonly')) %}
        <div class="d-flex justify-content-between align-items-center mb-3">
            <small class="text-secondary">
                {% if secret.get('annotations', {}).get('cm_keyonly') %}
                &#128273; confidential
                {% else %}
                &#128274; readonly
                {% endif %}
            </small>
        </div>
        {% endif %}

        <form method="POST" enctype="multipart/form-data">
            <input type="hidden" name="credentials_name" value="{{ secret.name }}">
            <input type="hidden" name="type" value="kubernetes.io/ssh-auth">
            <input type="hidden" name="create" value="yes">
            {% if is_new_credential %} <h6>Type: ssh-auth</h6> {% endif %}
            <div class="clearfix"></div>
            <div class="mb-3">
                {% if not secret.data.get('ssh-privatekey') %}
                <label for="ssh_file" class="form-label">
                    <b>Upload</b> private key file:
                </label>
                <input class="form-control" type="file" id="ssh_file" name="ssh_file" accept="text/plain" />
                <br>
                <label for="privatekey" class="form-label">
                    <u><b>or</u> paste</b> your private key here:
                </label>
                <textarea class="form-control" id="privatekey" name="privatekey" style="min-height: 200px;"></textarea>
                <br>
                <h6>Caution: Once created, the private key cannot be viewed or modified within the Credentials Manager. To delete a key, please submit a request to the EOX OWS crew.</h6>
                {% else %}
                For security, private keys are non-viewable and immutable once stored in the Credentials Manager. To update/delete this secret please contact the EOX OWS crew.
                {% endif %}
            </div>
            <div id="form-buttons">
                {% if not (secret.get('annotations', {}).get('cm_readonly') or secret.get('annotations', {}).get('cm_keyonly')) %}
                <button type="submit" class="btn btn-success my-2">
                    {% if is_new_credential %} Create {% else %} Update {% endif %} Credential
                </button>
                {% endif %}
                <a href="../" type="button" class="btn btn-secondary">
                    {% if (secret.get('annotations', {}).get('cm_readonly') or secret.get('annotations', {}).get('cm_keyonly')) %}
                        Return
                    {% else %}
                        Cancel
                    {% endif %}</a>
            </div>
        </form>
    </div>
</div>

{% endblock %}
